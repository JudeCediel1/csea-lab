%============================================================% 1. experiment description %===========================================================disp ('ganz neu')subjectcode = input('overall subject code   ?    ','s');chWeight =input('channel wighting  (1 no, 2 trials) ?    ');subjectvec = ['01'; '02'; '04'; '07'; '08'; '09';'10'; '11'; '12';'13';'14';'15';'17'; '18';'19'; '21'; '22'; '24';'25'];%subjectvec = ['GM']condvec = ['1'; '2'; '3'; '4'; '5'; '6']%compute grand meanfor cond = 1 : length (condvec(:, 1))	for vp = 1 : length(subjectvec(:, 1))            file = ([subjectcode subjectvec(vp,:) '.at' condvec(cond,:) '.ar']);			path = 'Elnino:AS_exps:emosteady:Aganzneu:atg_merged_19:';			FilePath = ([path file])				if vp == 1				[AvgMat,File,Path,FilePath,NTrialAvgVec,StdMat,...				SampRate,AvgRef,Version,MedMedRawVec,MedMedAvgVec]=ReadAvgFile(FilePath);				[NChan,NPoints]=size(AvgMat);				size(StdMat)					if chWeight==1					MergeAvgMat=AvgMat;					elseif chWeight==2					MaxNumberOfTrials=max(NTrialAvgVec);					TotMaxNumberOfTrials=MaxNumberOfTrials;					MergeAvgMat=MaxNumberOfTrials.*AvgMat;					elseif chWeight==3					MergeAvgMat=AvgMat./StdMat; 					InvMergeStdMat=1./StdMat;					end				MergeStdMat=StdMat; 				MergeNTrialAvgVec=NTrialAvgVec;				MergeMedMedRawVec=MedMedRawVec;				MergeMedMedAvgVec=MedMedAvgVec;							else				[AvgMat,File,Path,FilePath,NTrialAvgVec,StdMat,...				SampRate,AvgRef,Version,MedMedRawVec,MedMedAvgVec]=ReadAvgFile(FilePath);				size(StdMat)				if chWeight==1				MergeAvgMat=MergeAvgMat+AvgMat;				elseif chWeight==2				MaxNumberOfTrials=max(NTrialAvgVec);				TotMaxNumberOfTrials=TotMaxNumberOfTrials+MaxNumberOfTrials;				MergeAvgMat=MergeAvgMat+MaxNumberOfTrials.*AvgMat;				elseif chWeight==3				MergeAvgMat=MergeAvgMat+AvgMat./StdMat;				InvMergeStdMat=InvMergeStdMat+1./StdMat;			end				MergeStdMat=MergeStdMat+StdMat;				%============Falls MergeNTrialAvgVec=NTrialAvgVec'=============				SizeMergeNTrialAvgVec=size(MergeNTrialAvgVec);				SizeNTrialAvgVec=size(NTrialAvgVec);				if SizeMergeNTrialAvgVec(2)==SizeNTrialAvgVec(1); NTrialAvgVec=NTrialAvgVec'; end				%==============================================================				MergeNTrialAvgVec=MergeNTrialAvgVec+NTrialAvgVec;				NMergeMedMedRawVec=length(MergeMedMedRawVec);				NMedMedRawVec=length(MedMedRawVec);				NTmpMedMedRaw=NMergeMedMedRawVec+NMedMedRawVec;				TmpMedMedRaw=zeros(NTmpMedMedRaw,1);				TmpMedMedRaw(1:NMergeMedMedRawVec)=MergeMedMedRawVec;				TmpMedMedRaw(NMergeMedMedRawVec+1:NTmpMedMedRaw)=MedMedRawVec;				MergeMedMedRawVec=TmpMedMedRaw;				NMergeMedMedAvgVec=length(MergeMedMedAvgVec);				NMedMedAvgVec=length(MedMedAvgVec);				NTmpMedMedAvg=NMergeMedMedAvgVec+NMedMedAvgVec;				TmpMedMedAvg=zeros(NTmpMedMedAvg,1);				TmpMedMedAvg(1:NMergeMedMedAvgVec)=MergeMedMedAvgVec;				TmpMedMedAvg(NMergeMedMedAvgVec+1:NTmpMedMedAvg)=MedMedAvgVec;				MergeMedMedAvgVec=TmpMedMedAvg;				end	end			AvgAvgMat = MergeAvgMat./ length(subjectvec(:, 1));		MergeStdMat=MergeStdMat./ length(subjectvec(:, 1));		OutFilePath = ['Elnino:tmpstats:GM' condvec(cond, :)];				SaveAvgFile(OutFilePath,AvgAvgMat,MergeNTrialAvgVec,MergeStdMat,SampRate,MergeMedMedRawVec,TmpMedMedAvg);		clear Gmeancond	clear MergeStdMat	end		