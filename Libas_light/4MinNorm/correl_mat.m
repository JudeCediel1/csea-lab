% Create correlation matrix for the rows of two given matrices% OH 22.10.1997function C=correl_mat(A,B);[rA, cA] = size(A);[rB, cB] = size(B);if cA~=cB,  disp(' Input data error in correl_mat ');  error(' Number of columns must agree ');end;% Compute norms of rows of A and BnA = norm_col(A');nB = norm_col(B');C = A*(B');    % Matrix with scalar products of rows of A and B% Divide rows of C by norms of rows of Afor i=1:rA,	C(i,:) = C(i,:)/nA(i);end;	% Devide colums of C by norms of rows of Bfor i=1:rB,	C(:,i) = C(:,i)/nB(i);end;				