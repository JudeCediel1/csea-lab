function polar = cart2polar(xyz);factor = 180.0/pi;for i=1:length(xyz(1,:)),	polar(3,i) = norm(xyz(:,i));			% radius	xy = sqrt(xyz(1,i)*xyz(1,i)+xyz(2,i)*xyz(2,i));	% Projection on xy-plane	if polar(3,i)==0,		polar(1,i) = 0 ;		polar(2,i) = 0;	elseif xy == 0,		polar(1,i) =  acos(xyz(3,i)/polar(3,i));		% theta (polar)		polar(2,i) = 0;						% phi (azimuth)	else		polar(1,i) =  acos(xyz(3,i)/polar(3,i));		polar(2,i) = acos(xyz(1,i)/xy);		if xyz(2,i)<0,			polar(2,i) = 2.0*pi-polar(2,i);		end;	end;	 end;polar(1:2,:) = factor*polar(1:2,:);