function d=diagprod(a,b)% diagonal of the product without creating all % the product matrix. Very fast and memory saving.% Use:instead of diag(A*B) use diagprod(A,B)%rgpm 2-1-1977[fa,ca]=size(a);[fb,cb]=size(b);if ca~=fb,  disp(' Input data error in DiagProd ');  error(' Inner dimensions must agree ');end;if fa~=cb,  disp(' Input data error in DiagProd ');  error(' Outer dimensions must agree ');end;d=zeros(fa,1);for i=1:fa,  d(i)=a(i,:)*b(:,i);end;%over  