% Given a leadfield matrix, a vector of regularization parameters, and a data vector% the residual variance of the pseudosolution for every regul. param. is computed and plotted% OH 09.12.97% uses res_var(), pinv_tikh()function [resvar] = find_regpar(lfdmat, regpars, data);if nargin==0,   disp(' [resvar] = find_regpar(lfdmat, regpars, data); ');   return;end;for i=1:length(regpars),   disp(regpars(i));   disp('Computing pseudoinverse (G)');   G = pinv_tikh(lfdmat, regpars(i));   inv = G*data;   resvar(i,:) = res_var(lfdmat, inv, data)';end;colours = char('r', 'b', 'g', 'm', 'c', 'y', 'b', 'w'); lgnd = char('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20' );clf;for i=1:length(data(1,:)),	if i<length(colours),      c = sprintf('%s', colours(i));	else      c = 'k';   end;   plot(regpars, resvar(:,i), c); hold on;end;legend(lgnd(1:min(length(data(1,:)),length(lgnd(:,1))),:), 2); hold on;for i=1:length(data(1,:)),	if i<length(colours),      c = sprintf('%sx', colours(i));	else      c = 'kx';   end;   plot(regpars, resvar(:,i), c); hold on;end;xlabel('Regularisierungsparameter');ylabel('Restvarianz');