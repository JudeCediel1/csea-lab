% getcon_emolex
% searches condnumbers  and pulls out RTs in log generated by emolex study file
% con1 = erotic, con2 = families, con3 = neutral, con4 = loss; con5 = threat, con6 =
% mutil

function [contentvec, respvec, correctvec, stimvec] = getcon_emolex(filepath)

stimvec = []; 
correctvec = []; 
contentvec = [];
respvec = [];

fid = fopen(filepath);
trialcount = 1;
a = 1;

while a > 0
    
    a = fgetl(fid);
        
    if a < 0, break, return, end
    
    blankindex = find(a == ' ');
   
    a(blankindex(3)+1:blankindex(3)+4)
   
    if strcmp(a(blankindex(3)+1:blankindex(3)+4) ,'erot'), contentvec = [contentvec 1];
    elseif strcmp(a(blankindex(3)+1:blankindex(3)+4) ,'fami'), contentvec = [contentvec 2];
    elseif strcmp(a(blankindex(3)+1:blankindex(3)+4) ,'neut'), contentvec = [contentvec 3];
    elseif strcmp(a(blankindex(3)+1:blankindex(3)+4) ,'loss'), contentvec = [contentvec 4];
    elseif strcmp(a(blankindex(3)+1:blankindex(3)+4) ,'huma'), contentvec = [contentvec 5];
    else contentvec = [contentvec 6];
    end
    
    % now.. let's pull out RTs
    respvec = [respvec; str2num(a(blankindex(6)+1:blankindex(7)-1))];
    
    % now..... let's pull out the Ns and As
    correctvec = [correctvec; a(blankindex(7)+1)];
    
    % determine if it is word or pseudoword
    stimvec = [stimvec; a(blankindex(4)+1)];
    
    trialcount = trialcount + 1;
    
end % end loop over lines (=trials)


% do the maths
%

% 1. find indices
% correct responses only
% words
index_eroWordCorrect = find(correctvec == 'C' & contentvec' == 1 & stimvec == 'w' & respvec > 100); 
index_famWordCorrect = find(correctvec == 'C' & contentvec' == 2 & stimvec == 'w' & respvec > 100); 
index_neutWordCorrect = find(correctvec == 'C' & contentvec' == 3 & stimvec == 'w' & respvec > 100); 
index_lossWordCorrect = find(correctvec == 'C' & contentvec' == 4 & stimvec == 'w' & respvec > 100); 
index_threatWordCorrect = find(correctvec == 'C' & contentvec' == 5 & stimvec == 'w' & respvec > 100); 
index_mutilWordCorrect = find(correctvec == 'C' & contentvec' == 6 & stimvec == 'w' & respvec > 100); 

% pseudowords 
index_eroP_wordCorrect = find(correctvec == 'C' & contentvec' == 1 & stimvec == 'p' & respvec > 100); 
index_famP_wordCorrect = find(correctvec == 'C' & contentvec' == 2 & stimvec == 'p' & respvec > 100); 
index_neutP_wordCorrect = find(correctvec == 'C' & contentvec' == 3 & stimvec == 'p' & respvec > 100); 
index_lossP_wordCorrect = find(correctvec == 'C' & contentvec' == 4 & stimvec == 'p' & respvec > 100); 
index_threatP_wordCorrect = find(correctvec == 'C' & contentvec' == 5 & stimvec == 'p' & respvec > 100); 
index_mutilP_wordCorrect = find(correctvec == 'C' & contentvec' == 6 & stimvec == 'p' & respvec > 100); 


%responsevectors - words
RTvec_eroWordCorrect = respvec(index_eroWordCorrect); 
RTvec_famWordCorrect  = respvec(index_famWordCorrect); 
RTvec_neutWordCorrect  = respvec(index_neutWordCorrect); 
RTvec_lossWordCorrect   = respvec(index_lossWordCorrect ); 
RTvec_threatWordCorrect  = respvec(index_threatWordCorrect); 
RTvec_mutilWordCorrect  = respvec(index_mutilWordCorrect); 

% responsevector pseudowords
RTvec_eroP_wordCorrect = respvec(index_eroP_wordCorrect); 
RTvec_famP_wordCorrect  = respvec(index_famP_wordCorrect); 
RTvec_neutP_wordCorrect  = respvec(index_neutP_wordCorrect); 
RTvec_lossP_wordCorrect   = respvec(index_lossP_wordCorrect ); 
RTvec_threatP_wordCorrect  = respvec(index_threatP_wordCorrect); 
RTvec_mutilP_wordCorrect  = respvec(index_mutilP_wordCorrect); 

figure(1) , 
subplot(6,1,1), hist(RTvec_eroWordCorrect), axis([100 2500 0 10]), title('words'); 
subplot(6,1,2), hist(RTvec_famWordCorrect), axis([100 2500 0 10])
subplot(6,1,3), hist(RTvec_neutWordCorrect), axis([100 2500 0 10])
subplot(6,1,4), hist(RTvec_lossWordCorrect), axis([100 2500 0 10])
subplot(6,1,5), hist(RTvec_threatWordCorrect), axis([100 2500 0 10])
subplot(6,1,6), hist(RTvec_mutilWordCorrect), axis([100 2500 0 10]), title('mutilation'); 

figure(2),
subplot(6,1,1), hist(RTvec_eroP_wordCorrect), axis([100 2500 0 10]), title('pseudowords');  
subplot(6,1,2), hist(RTvec_famP_wordCorrect), axis([100 2500 0 10])
subplot(6,1,3), hist(RTvec_neutP_wordCorrect), axis([100 2500 0 10])
subplot(6,1,4), hist(RTvec_lossP_wordCorrect), axis([100 2500 0 10])
subplot(6,1,5), hist(RTvec_threatP_wordCorrect), axis([100 2500 0 10])
subplot(6,1,6), hist(RTvec_mutilP_wordCorrect), axis([100 2500 0 10]), title('mutilation'); 


% medians for words
median_RTvec_eroWordCorrect = median(RTvec_eroWordCorrect);
median_RTvec_famWordCorrect= median(RTvec_famWordCorrect);
median_RTvec_neutWordCorrect= median(RTvec_neutWordCorrect);
median_RTvec_lossWordCorrect= median(RTvec_lossWordCorrect);
median_RTvec_threatWordCorrect= median(RTvec_threatWordCorrect);
median_RTvec_mutilWordCorrect= median(RTvec_mutilWordCorrect);

% medians for pseudowords
median_RTvec_eroP_wordCorrect = median(RTvec_eroP_wordCorrect);
median_RTvec_famP_wordCorrect= median(RTvec_famP_wordCorrect);
median_RTvec_neutP_wordCorrect= median(RTvec_neutP_wordCorrect);
median_RTvec_lossP_wordCorrect= median(RTvec_lossP_wordCorrect);
median_RTvec_threatP_wordCorrect= median(RTvec_threatP_wordCorrect);
median_RTvec_mutilP_wordCorrect= median(RTvec_mutilP_wordCorrect);

% medians for words and pseudowrds
medianvecwords = [ median_RTvec_eroWordCorrect median_RTvec_famWordCorrect median_RTvec_neutWordCorrect ...
  median_RTvec_lossWordCorrect  median_RTvec_threatWordCorrect median_RTvec_mutilWordCorrect];

medianvecPwords = [ median_RTvec_eroP_wordCorrect median_RTvec_famP_wordCorrect median_RTvec_neutP_wordCorrect ...
  median_RTvec_lossP_wordCorrect  median_RTvec_threatP_wordCorrect median_RTvec_mutilP_wordCorrect];

figure (3), bar(medianvecwords), axis([0 7 400 800])
figure (4), bar(medianvecPwords), axis([0 7 400 800])

% percent correct by condition
corrW_1 = length(index_eroWordCorrect)/15;
corrW_2 = length(index_famWordCorrect)/15;
corrW_3 = length(index_famWordCorrect)/15;
corrW_ = length(index_famWordCorrect)/15;
corrW_2 = length(index_famWordCorrect)/15;


% 
% 

fclose('all')
contentvec = contentvec';
contentRTmat = [contentvec respvec ];
eval(['save ' filepath '.con contentvec -ascii'])

