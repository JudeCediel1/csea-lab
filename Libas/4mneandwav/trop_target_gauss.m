% Compute Gaussian target function for the TROP method% "gridloc" : grid locations of the leadfield% "locations" : locations of the solution dipoles% "orientations" : orientations of the solution dipoles% "dim" : Number of components of solution dipoles (1,2,3)% "width" : standard deviation for gauss peak around target pointfunction [target, expval] = trop_target_gauss(gridloc, locations, dim, width);if isempty(dim), dim=1; end;nr_locations = length(locations(1,:));nr_gridpoints = length(gridloc(1,:));width2 = 2*width*width;factor = 1/(width*sqrt(2*pi));cnt = 1;for i=1:nr_locations,   diff(1,:) = gridloc(1,:) - locations(1,i);   diff(2,:) = gridloc(2,:) - locations(2,i);   diff(3,:) = gridloc(3,:) - locations(3,i);   dist = norm_col(diff);   clear diff;   expval = factor*exp(-dist.*dist/width2);   clear dist;   for j=1:dim,				% Components for which target vector shall be computed      for k = 1:dim,				% Component within one target vector         elemvec = k:dim:dim*nr_gridpoints;         if k==j,            target(elemvec,i+j-1) = expval;         else            target(elemvec,i+j-1) = 0.0;         end;      end;	% k   end;	% jend;	% i   