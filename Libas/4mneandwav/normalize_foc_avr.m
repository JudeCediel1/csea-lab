% normalize FileToNormalize by dividing by the RMS of a Focus of NormalizerFile% this is the McCarthy&Wood 1985 Correction iff the NormalizerFile is the % GrandMean over all subjects of the condition and the Focus is all dipolesfunction [cool] = normalize_avr(FileToNormalize, NormalizerFile, FocDefFile, OutputFile); [indata , latencies] = read_avr(FileToNormalize);[normalizerdata] = read_avr(NormalizerFile);[FocDef, DummyName, FocDefCols] = read_matrix ('','',FocDefFile);% disp('____');%disp(size(FocDef,1));%disp(size(FocDef,2));rmsofnormalizer = zeros(1,size(normalizerdata,2));for k = 1:size(normalizerdata,2); NoOfDips = 0;   for j = 1:size(FocDef,1),   for i = 1:FocDefCols(j),      NoOfDips = NoOfDips +1;      currentnormvalue = normalizerdata(FocDef(j,i),k);      rmsofnormalizer(k) = rmsofnormalizer(k) + currentnormvalue * currentnormvalue;   end; end;end;rmsofnormalizer = sqrt(rmsofnormalizer./NoOfDips);%for k = 1:size(normalizerdata,2);% disp(rmsofnormalizer(k));%end;for j = 1:size(normalizerdata,2),  for i = 1:size(normalizerdata,1)   outdata (i,j) = indata (i,j) ./ rmsofnormalizer(j);  end;end;if length(latencies)>1, interval=latencies(2)-latencies(1); else, interval=1; end;write_avr(outdata, OutputFile, latencies(1), interval);