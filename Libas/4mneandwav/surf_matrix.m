% Plot matrix, one coloured patch for every (i,j)-element% Plot either with matrix indices (only one argument) or given tics ( three % arguments, even spacing assumed)% OH 22.10.97function surf_matrix(A, x, y);if nargin==0,   disp(' surf_matrix(A, x, y); ');   return;end;B = A;if nargin == 1			% Only a matrix given		[m,n] = size(B);	B(m+1,:) = zeros(1,n);	B(:,n+1) = zeros(m+1,1);	tix = 0.5:1:n+0.5;	tiy = 0.5:1:m+0.5;	surf(tix, tiy, B); 	view([0,0,1]);	axis([0.5 n+0.5 0.5 m+0.5]);	colorbar;	end;      % if nargin == 1if nargin == 3			% A matrix and x/y-tics given		n = length(x);	m = length(y);	B(m+1,:) = zeros(1,n);	B(:,n+1) = zeros(m+1,1);	dx = x(2)-x(1);		% Even grid spacing assumed	dy = y(2)-y(1);	tix = x(1)-dx/2:dx:x(n)+dx/2;	tiy = y(1)-dx/2:dy:y(m)+dx/2;	surf(tix, tiy, B); 	view([0,0,1]);	axis([tix(1) tix(n+1) tiy(1) tiy(m+1)]);	colorbar;	end;     % if nargin == 3clear B;clear tix;clear tiy;