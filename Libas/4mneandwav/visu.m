% Application of pseudoinverse on Patricks visual data (P3 experiment)  function  [elpsph, elpxyz, data, diploc, lfdmat, G, inv_sol] = visu(lfdmat);disp('Reading in elp-file');elpsph = read_elp('MadMac:matlab:data:pb_visu:65.elp');elpxyz = elp2coor(elpsph, 1.0);disp('Reading in data');data = read_matrix(65, 91, 'MadMac:matlab:data:pb_visu:farn.asc');disp('Creating source space');diploc = srcspace_xyz(0.8, 0.2, -0.6);if isempty(lfdmat),	disp('Computing leadfield matrix');	lfdmat = compute_lfdmat(diploc, elpxyz);else	disp('Reading in leadfield matrix');	lfdmat = read_matrix(1,1,'MadMac:matlab:data:pb_visu:lead.dat');end;disp('Average referencing leadfield matrix');lfdmat = avg_ref(lfdmat);disp('Computing pseudoinverse');G = pinv_tikh(lfdmat, 0.1);disp('Computing solution');inv_sol = inv_recon(G,  data(:,15));disp('Viewing solution');view_slices(diploc, inv_sol);