% Compute Gaussian target function for the TROP method% "gridloc" : grid locations of the leadfield% "locations" : locations of the solution dipoles% "orientations" : orientations of the solution dipoles% "dim" : Number of components of solution dipoles (1,2,3)% "width" : standard deviation for gauss peak around target pointfunction target = trop_target_gauss(gridloc, locations, dim, width);if isempty(dim), dim=1; end;nr_locations = length(locations(1,:));nr_gridpoints = length(gridloc(1,:));width2 = 2*width*width;factor = 1/(width*sqrt(2*pi));cnt = 1;for i=1:dim*nr_locations,   for j=1:dim*nr_gridpoints,      d = norm(locations(:,ceil(i/dim))-gridloc(:,ceil(j/dim)));      if mod(i-j,dim)==0,			% Same component         target(j,i) = factor*exp(-d*d/width2);      else								% Different component         target(j,i) = 0.0;      end;   end;end;   