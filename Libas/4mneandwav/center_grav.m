% Computes "centre of gravity" for columns in wgt_mat whose elements correspond to% rows in param (only absolute values in wgt_mat are used!)% The i-th column in param is weighted with the i-th element of a column of wgt_mat,% successively from column "from" to column "to" of wgt_mat% Application example: param may be theta/phi-coordinates of electrodes from an % *elp-file, wgt_mat may be a data matrix, then vec gives the centre of gravity for% potential topographies (note that only absolute values of wgt_mat are used!)% OH 25.10.97function [vec] = center_grav(param, wgt_mat, from, to);[mp, np] = size(param);[mw, nw] = size(wgt_mat);n = min([np mw]);if nargin == 2	from = 1;	to = nw;end;cnt = 1;for i=from:to	for j=1:mp		vec(j,cnt) = 0;		for k=1:n			vec(j,cnt) = vec(j,cnt) + param(j,k)*abs(wgt_mat(k,i));		end;	end;	sum = abs(wgt_mat(:,i))'*ones(mw,1);	vec(:,cnt) = vec(:,cnt)/sum;	cnt = cnt+1;end;