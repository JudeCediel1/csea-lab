function lead=lf1(e,d);% computes the leadfield relating sensor e with solution point d% assumes conductivity=1, there is no factor 1/4*pi*sigma, sphere with radio=1.% e=(xe,ye,ze) electrode coordinates.% d=(xd,yd,zd) dipole or solution points coordinates.% lead=(lx,ly,lz) resulting leadfield components.% reprogramed 1-1-97 from Delia version to be faster % is really faster in Matlab?  not checked!e=e(:); d=d(:);  %column vectorsdn=norm(e-d,2);d3=2/dn^3;ol=sum(e.*d);dd1s=dn*(dn + 1.0 - ol);factore=d3+ (1/dn) + (ol/dd1s);factord=d3+ (1/dd1s);lead=(factore*e-factord*d);%over