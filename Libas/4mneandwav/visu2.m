% Application of pseudoinverse on Patricks visual data (P3 experiment)function  [elpsph, elpxyz, data, diploc, lfdmat, G, inv_sol] = visu(lfdmat, G);disp('Reading in elp-file');elpsph = read_elp('MadMac:matlab:data:pb:pb_visu:65.elp');elpxyz = elp2coor(elpsph, 1.0);disp('Reading in data');data = read_matrix(65, 91, 'MadMac:matlab:data:pb:pb_visu:fvln.asc');  disp('Creating source space');diploc = srcspace_xyz(0.8, 0.1, -0.6);if nargin==0,	disp('Reading in  leadfield matrix');	lfdmat =read_matrix(6189, 65, 'MadMac:matlab:data:pb:leadfields:lead65_08_01_-06.dat');	lfdmat = lfdmat';%	disp('Average referencing leadfield matrix');%	lfdmat = avg_ref(lfdmat);end;if nargin<2,	disp('Computing pseudoinverse');	clear G;	G = pinv_tikh(lfdmat, 0.02);end;disp('Computing solution');inv_sol = inv_recon(G,  data(:,26), 3);disp('Viewing solution');figure(1);title('Visual N1');view_slices(diploc, inv_sol);print -dmfile MadMac:matlab:data:pb:pb_visu:n1;