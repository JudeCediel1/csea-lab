% Reads in data from BESA/FOCUS-*.avr-Filesfunction [data, latencies, name, pathname] = read_avr(filename);if nargin==0,		% No name specified	[name, pathname] = uigetfile('*.avr', 'Choose a BESA-*.avr-file!');	filename = sprintf('%s%s', pathname, name);end;disp(filename);fid = fopen(filename, 'r');line = fgetl(fid);if ~strcmp(line(1:10),'TimePoints'),		% "Traditional" *.avr-header	[dummy, remainder] = strtok(line);	if strcmp(dummy, 'Npts=')==0, disp('1This is not an *.avr-header!!!'); fclose(fid); return; end;	[dummy, remainder] = strtok(remainder);			% Number of timepoints (number of columns)	nr_timepoints = str2num(dummy);	[dummy, remainder] = strtok(remainder);	if strcmp(dummy, 'TSB=')==0, disp('2This is not an *.avr-header!!!'); fclose(fid); return; end;	[dummy, remainder] = strtok(remainder);					% Begin of latency range	offset = str2num(dummy);	[dummy, remainder] = strtok(remainder);	if strcmp(dummy, 'DI=')==0, disp('3This is not an *.avr-header!!!'); fclose(fid); return; end;	[dummy, remainder] = strtok(remainder);				% Intervall between sample points (ms)	sample_int = str2num(dummy);	[dummy, remainder] = strtok(remainder);	if strcmp(dummy, 'SB=')==0, disp('4This is not an *.avr-header!!!'); fclose(fid); return; end;	[dummy, remainder] = strtok(remainder);					% Number of bins per microvolt	nr_bins = str2num(dummy);	[dummy, remainder] = strtok(remainder);	if strcmp(dummy, 'SC=')==0, disp('5This is not an *.avr-header!!!'); fclose(fid); return; end;	[dummy, remainder] = strtok(remainder);					% Calibration factor	calib = str2num(dummy);      [dummy, remainder] = strtok(remainder);   if strcmp(dummy, 'Nchan='),      fgetl(fid);			% Skip second line if necessary      [dummy, remainder] = strtok(remainder);					% Calibration factor      nr_channels = str2num(dummy);   end;      data = fscanf(fid, '%f', [nr_timepoints, inf]);   %data = data'; 	   nr_timepoints = size(data,2);   latencies = offset:sample_int:(nr_timepoints-1)*sample_int+offset;	   text = sprintf('Timepoints: %d,  Offset: %f,  Sample interval: %f,  Bins: %d,  Calibration: %f', nr_timepoints, offset, sample_int, nr_bins, calib);   disp(text);else,		% FOCUS *.avr-header       disp('ERROR: not a besa-file'); end;   fclose(fid);