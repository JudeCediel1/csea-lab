% Create sourcespace (dipole locations) in a sphere% Locations are equally spaced by distance% Sphere radius is "radius" (surprise, surprise!)% Locations with z<cut_bottom are excluded (default: -radius)% OH 23.10.97function [diploc] = srcspace_sph(outerradius, radstep, distance, cut_bottom);if nargin == 3	cut_bottom = -outerradius;end; cnt = 1;for radius = outerradius:-radstep:(radstep/100),	quot = cut_bottom/radius;	if quot<1,		if quot<=-1,			outertheta = pi;		else			angle = acos(abs(cut_bottom)/radius);			if cut_bottom>=0,				outertheta=angle;			else				outertheta = pi-angle;			end;		end;		thetastep = distance/radius;		for theta = 0:thetastep:outertheta,			if theta==0 | theta==pi,				diploc(1,cnt) = 0;				diploc(2,cnt) = 0;				diploc(3,cnt) = radius*sign(1-theta);				cnt = cnt+1;			else				rxy = radius*sin(theta);				phistep = distance/rxy;				for phi = 0:phistep:2*pi-phistep*3/4,  % phistep/4 avoids too nearly spaced locations at the beginning/end of one circle					diploc(1,cnt) = rxy*cos(phi);					diploc(2,cnt) = rxy*sin(phi);					diploc(3,cnt) = radius*cos(theta);					cnt = cnt+1;					end;   % for phi			end; %  else		end;    % for theta	end; % if quotend;   % for radius