% Find maximum values of impulse responses for inverse G and forward solutions% forward, outputs elements of impulse response with maximum value% G: (generalized) inverse% forward: forward solutions% dim: if dim>1 dim neighbouring elements of G are assumed to belong to one location,% and the absolute value for every location is taken for the impulse response% OH 05.02.98% uses inv_recon()function [max_values, max_elem] = dle_value_elem(G, forward, dim);if nargin==0,   disp(' [max_values, max_elem] = dle_value_elem(G, forward, dim); ');   return;end;[mf, nf] = size(forward);[mg, ng] = size(G);for i=1:nf,   if mod(i,100)==0,      text = sprintf('Impulse response for dipole %d', i);      disp(text);   end;   impresp = inv_recon(G, forward(:,i), dim);   [max_values(i), max_elem(i)] = max(abs(impresp));end;max_values = max_values';max_elem = max_elem';