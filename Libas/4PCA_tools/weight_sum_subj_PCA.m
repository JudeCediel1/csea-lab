% weight_sum_subj_PCA% multiplies each spatial component in compmat% with individual SCADS at*.ar files and saves% weighted sums across electrodes to new files for each% subject ==> one time series for each subject and componentfunction [] = weight_sum_subj_PCA(compmat, filemat, outdir, bslvec)if nargin < 3     % if no outdir specified==> outdir = indir		k = findstr(filemat(1,:), ':');	outdir = filemat(1, 1:max(k))else	outdirend% find filenamepart (no directory) of filematk = findstr(filemat(1,:), ':');		fnamevec = max(k)+1:length(filemat(1,:));for fileindex = 1 : size(filemat, 1); 		ERPmat = ReadAvgFile(filemat(fileindex, :));         ERPmat = bslcorr(ERPmat,bslvec);		weightsum_mat = ERPmat' * compmat; 			eval(['save ' outdir '/' filemat(fileindex,:) '.w_sum  weightsum_mat  -ascii'])				%SaveAvgFile([outdir filemat(fileindex, fnamevec(1:length(fnamevec)-14)) 'MN_weigh_sum.at'], weightsum_mat')		fprintf('saving weighted sum to file nummber  %g', fileindex)end			