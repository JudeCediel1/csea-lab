% GENERDATNEWfunction[TFpower, TFpli, data]=gd_audigam(ntrials)t = [0:0.004:.040]; wavelet = gener_Wav(300, 1, 25, 100);WAsum = []; WAPLIsum = []; for trial = 1:ntrials    jitterval = round(rand(1,1).*3);     sig1 = sin(2*pi*t.*44).*.68 + (rand(size(t))-0.3) +  sin(2*pi*t.*20).*.68 + (rand(size(t))-0.3);sig2 = sin(2*pi*t.*44).*.64;+ (rand(size(t)));s1 = (rand(1,300)-0.5).*.75;s2 = (rand(1,300)-0.5).*.45 ;sigAdd = [zeros(1,110+jitterval) sig1 zeros(1,25) sig2 zeros(1,143-jitterval)];data = sigAdd + 2* s1 +2 *s2; % figure(1)% plot(data, 'k')[WAPower, WARaighley]=wa_new(data', wavelet, 300, 1, 25, 100,300);faxis = 20:0.83:83;taxis = -400:4:800-4;% figure(2)% subplot(2,1,1), contourf(taxis, faxis, WAPower), colorbar% subplot(2,1,2), contourf(taxis, faxis, WARaighley), colorbar% pause(1)if trial ==1    WAsum = WAPower;     WAPLIsum = WARaighley;else    WAsum = WAsum + WAPower;     WAPLIsum = WAPLIsum + WARaighley;endendTFpower  = WAsum./ntrials;TFpli = abs(WAPLIsum ./ntrials) ;figure(3) subplot(2,1,1), contourf(taxis, faxis, TFpower), colorbarsubplot(2,1,2), contourf(taxis, faxis, TFpli), colorbar