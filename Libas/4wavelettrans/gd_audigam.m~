% GENERDATNEWfunction[WAPower, WARaighley, data]=gd_audigam(ntrials)t = [0:0.004:.040]; wavelet = gener_Wav(300, 1, 25, 100);WAsum = []; WAPLIsum = []; for trial = 1:ntrialssig1 = sin(2*pi*t.*41).*.88 + (rand(size(t))-0.6);sig2 = sin(2*pi*t.*43).*.40;+ (rand(size(t)));s1 = (rand(1,300)-0.5).*.55;s2 = (rand(1,300)-0.5).*.55 ;sigAdd = [zeros(1,110) sig1 zeros(1,25) sig2 zeros(1,143)];data = sigAdd + 2* s1 +2 *s2; figure(1)plot(data, 'k')[WAPower, WARaighley]=wa_new(data', wavelet, 300, 1, 25, 100,300);faxis = 20:0.83:83;taxis = -400:4:800-4;figure(2)subplot(2,1,1), contourf(taxis, faxis, WAPower), colorbarsubplot(2,1,2), contourf(taxis, faxis, WARaighley), colorbarpause(1)if trial ==1    WAsum = WAPower;     WAPLIsum = WARaighley;else    WAsum = WAsum + WAPower;     WAPLIsum = WAPLIsum + WARaighley;endendWAsum./NTrials;figure(3) subplot(2,1,1), contourf(taxis, faxis, WAPower), colorbarsubplot(2,1,2), contourf(taxis, faxis, WARaighley), colorbar