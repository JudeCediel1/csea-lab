% D_stat_topos% computes D-statistic for comparison of two topographies (matrices% with [elec X time points]) % also computes permutation distribution for signif. test% Nsens4D = number of sensors four D statisticfunction 	[D] = D_stat_topos(topo1, topo2, Nsens4D);						[topo1_sorted_ascend, Index_1] = sort(topo1);			[topo2_sorted_ascend, Index_2] = sort(topo2);						% vectors: elecs sorted in descending order (max two min)				elec_sorted_1 = flipud(Index_1);			elec_sorted_2 = flipud(Index_2);						elec_sorted_1 = elec_sorted_1(1:Nsens4D);			elec_sorted_2 = elec_sorted_2(1:Nsens4D);						% compute distances						load ElNino:MATLAB:Libas:4data:elek.dat;						elek = (elek * 100)';							diffvecX = elek(elec_sorted_1,1) - elek(elec_sorted_2,1);			diffvecY = elek(elec_sorted_1,2) - elek(elec_sorted_2,2);			diffvecZ = elek(elec_sorted_1,3) - elek(elec_sorted_2,3);				% euklidische distanzen			diffvecabs = sqrt(diffvecX.^2 + diffvecY.^2 + diffvecZ.^2);						% h ueber linie AB			h = 8.2 - sqrt((8.2^2 - diffvecabs.^2) ./4);												% bogendistanz			l = (4.*pi.*8.2.*diffvecabs.*cos((8.2-h)./8.2)) ./ 360;									D = (sum(l))./Nsens4D; 																											