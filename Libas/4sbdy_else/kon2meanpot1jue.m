% berechnet Meanpotentials aus ATG.ar konstanz file fuer ein anzugebendes Zeit-% fenster im Batchbetriebclear%bed = input('name of condition?         ','s')timewins = input(' time window to select and average? (in samppoints) (form: [x y; a b; etc])    ')ascii1_name = input('ascii name for result?      ','s')trans = input('transformiere nach MCCarthy and wood (y/n)?   ','s')bslvec = input('baseline (sample points a:b)      ')%vps = ['IA01';'IA04';'IA05';'IA06';'IA07';'IA08';'IA09';'IA11';'IA16';'IA17';'IA21']; % IAPS%vps = ['02';'04';'05';'06';'07';'08';'09';'10';'11';'12';'14'];  %brot%vps = ['HS97001_';'HS97003_';'HS98005_';'HS98009_';'HS98011_';'HS98013_';'NS98004_';'NS98006_';'NS98007_';'NS98008_';'NS98010_'; 'NS98012_'];   %hypnovps = ['CM';'BS';'HM';'CW';'VD';'SR';'SP';'SG';'JE';'DP';'BO']ascii1_name for bed = 1 :16 pfad = ['ubies:fremdstuff:AAAAH'] %  pfad = ['UBIES:iaps:atgfiles']for vpindex = 1 : size(vps,1)   % schleife ueber subjects  vp = vps(vpindex,:); file = [ vp 'E2.AT' num2str(bed) '.ar.at1.f']; % hypno bruno% file = [ vp '.Merge.at' bed]FilePath = [ pfad ':' file]% baseline abziehen[ERPmat] = ReadAvgFile(FilePath);   % liest einfor chan = 1 : 129BslCorMat(chan,:) = ERPmat(chan,:)-mean(ERPmat(chan,bslvec));end% berechne  meanpotentials  % transformiere nach MCCarty and wood        if trans == 'y'        for t = 1 : length (BslCorMat);            teilmat = BslCorMat(:,t);            minimum = min(teilmat);            maximum = max(teilmat);                        for elek = 1 : 129                neumat(elek, t) = (BslCorMat(elek,t)-minimum)/(maximum - minimum);            end        end    else neumat = BslCorMat;	end	    % schreibe gemittelte werte fuer jede elektrode in superanova-format 	ERPneuvec1 = mean(neumat(:,[timewins(1,1):timewins(1,2)])');ERPsamat(vpindex, [1:129]) = ERPneuvec1;end if trans == 'y'	 ascii1_name = ([ascii1_name 'MW']); end name = [ascii1_name num2str(bed)] eval(['save ubies:Users:juergen:' name ' ERPsamat -ascii'])  % hypno%eval (['save ubies:iaps:fuer_stats:'ascii1_name ' ERPsamat -ascii']) %IAPSdisp('saving file'), disp(ascii1_name)end