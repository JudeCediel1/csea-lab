% berechnet Autokorr und Crosscorr fuer P 50 und evoz. gammadisp('select files')% files einlesen[p50file, p50path] = uigetfile('ubies:fremdstuff:niko:*.asc', 'select p50file');[gamfile, gampath] = uigetfile('ubies:fremdstuff:niko:*.asc', 'select gamma file');disp (' Autocorrelation function')matlengthp50 = length(p50file)-4;matlengthgam = length(gamfile)-4;p50filepath = ([p50path p50file]);gamfilepath = ([gampath gamfile]);load (p50filepath)load (gamfilepath)p50mat = eval(p50file(1:matlengthp50));gammat = eval(gamfile(1:matlengthgam));p50autocormat = zeros(8,100);gamautocormat = zeros(8,100);crosslagmat = zeros(8,100);for channel = 1 : 8	for lag = 0 : 99		p50chanvec = p50mat(:,channel);		p50corrdummy = corrcoef(p50chanvec(1:length(p50chanvec)-lag), p50chanvec(lag+1 : length(p50chanvec)));		p50chancorvec(lag+1) = p50corrdummy(1,2);				gamchanvec = gammat(:,channel);		gamcorrdummy = corrcoef(gamchanvec(1:length(gamchanvec)-lag), gamchanvec(lag+1 : length(gamchanvec)));		gamchancorvec(lag+1) = gamcorrdummy(1,2);						crosslagdummy = corrcoef(p50chanvec(1:length(p50chanvec)-lag), gamchanvec(lag+1 : length(p50chanvec)));		crosslagvec(lag+1) = crosslagdummy(1,2);	end		p50autocormat(channel,:) = p50chancorvec	;	gamautocormat(channel,:) = gamchancorvec	;	crosslagmat(channel,:) = crosslagvec ; enddisp (' Cross-correlation')for channel = 1 : 8		p50chanvec = p50mat(:,channel);	gamchanvec = gammat(:,channel);	crossdummy1 = corrcoef(p50chanvec, gamchanvec);	crossdummyshort = corrcoef(p50chanvec([80:150],:), gamchanvec([80:150],:));	crossdummy2 = corrcoef(p50chanvec([350:400],:), gamchanvec([350:400],:));			crosswithinp50 = corrcoef(p50chanvec([100:150],:), p50chanvec([350:400],:));	crosswithingam = corrcoef(gamchanvec([100:150],:), gamchanvec([350:400],:));		crosscorrvec(channel,:) = crossdummy1(1,2);	shortcorrvec(channel,:) = crossdummyshort(1,2);		crossvec2(channel,:) = crossdummy2(1,2);		crossvecwithinp50(channel,:) = crosswithinp50(1,2);	crossvecwithingam(channel,:) = crosswithingam(1,2);				enddisp ('press key to plot results')pausefigure(1)plot (p50autocormat')title ('p50 autocorrelation function')figure(2)plot (gamautocormat')title ('gamma autocorrelation function')figure(3)plot(crosscorrvec), axis([1 8 0 1])title ('cross-correlation across whole time series')xlabel('electrode nr')  figure(4)plot(crosslagmat'), title ('cross-correlation with lag across whole time series')xlabel('lag')  