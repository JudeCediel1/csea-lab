function [topo_zmat, mat3d_1, mat3d_2] = topottest_ranks(filemat1, filemat2, bslvec, outname)if nargin < 4;     outname = []; end[a,File,Path,FilePath,NTrialAvgVec,StdChanTimeMat,...	SampRate,AvgRef,Version,MedMedRawVec,MedMedAvgVec,EegMegStatus,...    NChanExtra,TrigPoint,HybridFactor,HybridDataCell,DataTypeVal]=ReadAvgFile(deblank(filemat1(1,:))); mat3d_1 = zeros(size(a,1), size(a,2), size(filemat1,1) ); mat3d_2 = zeros(size(a,1), size(a,2), size(filemat1,1) ); topo_zmat = zeros(size(a,1), size(a,2)); for subject = 1:size(filemat1,1);        a = ReadAvgFile(deblank(filemat1(subject,:)));        if ~isempty (bslvec)    mat3d_1(:,:, subject) = bslcorr(a, bslvec);    else       mat3d_1(:,:, subject) = a;    end              b = ReadAvgFile(deblank(filemat2(subject,:)));           if ~isempty (bslvec)        mat3d_2(:,:, subject) = bslcorr(b, bslvec);       else          mat3d_2(:,:, subject) = b;       endenddisp('loop over data and compute signed rank test Z for sensor:') for elec = 1:size(mat3d_1,1),  fprintf('.'), if round(elec/10)==(elec/10), disp(elec), end    for colindex = 1:size(mat3d_1,1)        [P,H,STATS] = signrank(squeeze(mat3d_1(elec,colindex,:)), squeeze(mat3d_2(elec,colindex,:))', 'method', 'approximate');         topo_zmat(elec, colindex) = STATS.zval;     endendif isempty(outname); SaveAvgFile(outname,topo_zmat,NTrialAvgVec,StdChanTimeMat, ...    SampRate,MedMedRawVec,MedMedAvgVec,EegMegStatus,NChanExtra,TrigPoint,HybridFactor); else    SaveAvgFile(outname, topo_zmat,NTrialAvgVec,StdChanTimeMat, ...    SampRate,MedMedRawVec,MedMedAvgVec,EegMegStatus,NChanExtra,TrigPoint,HybridFactor); end        